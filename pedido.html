<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Finalizar Pedido</title>
  <link rel="stylesheet" href="stylepedido.css" />
  <style>
    .hidden { display: none; }
    .item-carrinho { margin-bottom: 10px; }
    .btn-remover { margin-left: 10px; }
  </style>
</head>
<body>
  <h1>Seu Pedido</h1>
  <div id="produto"></div>
<ul id="lista-carrinho"></ul>
  <h2>Dados para entrega</h2>
  <input type="text" id="nome" placeholder="Seu nome"><br><br>
  <input type="text" id="endereco" placeholder="Endereço de entrega"><br><br>

  <label for="observacoes">Observações:</label><br>
  <textarea id="observacoes" rows="4" cols="50" placeholder="Digite aqui alguma observação sobre o pedido..."></textarea><br><br>

  <label for="pagamento">Forma de pagamento:</label>
  <select id="pagamento">
    <option value="">Selecione</option>
    <option value="pix">PIX</option>
    <option value="credito">Cartão de Crédito</option>
    <option value="debito">Cartão de Débito</option>
  </select><br><br>

  <div id="qrcode" class="hidden">
    <p>Aqui estaria o QR Code do PIX</p>
  </div>

  <button onclick="enviarParaCliente()">Enviar</button>
  <button onclick="finalizarPedido()" id="botao-vendedora" class="hidden">Enviar para Vendedora</button>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
  const lista = document.getElementById("lista-carrinho");

  if (carrinho.length === 0) {
    lista.innerHTML = "<p>Seu carrinho está vazio.</p>";
    return;
  }

  carrinho.forEach(produto => {
  const item = document.createElement("li");
  item.textContent = `${produto.nome} - R$ ${produto.preco.toFixed(2)}`;
  lista.appendChild(item);
});
});
  function enviarParaCliente() {
  const nome = document.getElementById('nome').value;
  const endereco = document.getElementById('endereco').value;
  const observacoes = document.getElementById('observacoes').value;
  const formaPagamento = document.getElementById('pagamento').value;
  const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];

  if (!nome || !endereco || !formaPagamento || carrinho.length === 0) {
    alert('Preencha todos os campos e adicione produtos ao carrinho.');
    return;
  }

  const valorTotal = carrinho.reduce((total, item) => total + item.preco, 0);

  fetch('https://seu-projeto.vercel.app/api/create-pix', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      cliente: nome,
      endereco: endereco,
      observacoes: observacoes,
      pagamento: formaPagamento,
      valor: valorTotal,
      itens: carrinho
    })
  })
  .then(res => res.json())
  .then(data => {
    console.log(data);
    if (formaPagamento === 'pix') {
      document.getElementById('qrcode').classList.remove('hidden');
      // Aqui você pode exibir o QR Code real, se sua API retornar um link ou imagem
    }
    alert('Pedido enviado com sucesso!');
  })
  .catch(err => {
    console.error('Erro ao enviar pedido:', err);
    alert('Falha ao enviar pedido.');
  });
  }const qrDiv = document.getElementById('qrcode');
qrDiv.innerHTML = `
  <p>QR Code de teste:</p>
  <img src="https://api.qrserver.com/v1/create-qr-code/?data=PIX+TESTE&size=200x200" alt="QR Code de teste" />
`;
qrDiv.classList.remove('hidden');
</script>
  <script src="scriptpedido.js"></script>
</body>
</html>
